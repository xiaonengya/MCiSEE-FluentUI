name: Translation (Disabled)
run-name: Download Translations (Disabled)

on:
  # å·²ç¦ç”¨ï¼šéœ€è¦ Crowdin è®¿é—®æƒé™
  # schedule:
  #   - cron: 10 16 * * *
  workflow_dispatch:  # ä»…æ‰‹åŠ¨è§¦å‘

jobs:
  info:
    runs-on: ubuntu-latest
    steps:
      - name: Info
        run: |
          echo "â„¹ï¸  æ­¤ç¿»è¯‘å·¥ä½œæµå·²ç¦ç”¨"
          echo "ğŸ”‘ éœ€è¦é…ç½® Crowdin å¯†é’¥ï¼š"
          echo "   - CROWDIN_PROJECT_ID"
          echo "   - CROWDIN_PERSONAL_TOKEN" 
          echo "   - TOKEN (GitHub Token)"
          echo "ğŸ“ å¦‚éœ€å¯ç”¨ï¼Œè¯·åœ¨ä»“åº“ Settings > Secrets ä¸­é…ç½®å¯†é’¥"
      - name: Handle files
        id: handle
        run: |
          sudo chmod -R ugo+rwX .
          sed -i ":a;N;s/^    '\([a-z][a-z]-[A-Z][A-Z]\|lzh\)',\?\n//g;ta" scripts/init.js
          for TF in $(ls -r locales); do
            if [[ $TF == *.json ]]; then
              if [[ $(sed -n '$=' locales/$TF) -ge 12 ]]; then
                TL=$(basename $TF .json)
                sed -i -e '2i\  "language": "'$TL'",\n  "data": {' -e 's/^}/  }/g' -e '$a}' locales/$TF
                sed -i "s/\/\/ Crowdin/\/\/ Crowdin\n    '$TL',/g" scripts/init.js
              else
                rm locales/$TF
              fi
            fi
          done
          MESSAGE='modify: translations
          
          [Auto] Update Translation Files'"
          (Time: `date +'%F %X %Z'`)"
          EOF=$(dd if=/dev/urandom bs=15 count=1 status=none | base64)  # To define the separator
          echo "message<<EOF"$'\n'"$MESSAGE"$'\n'EOF >> $GITHUB_OUTPUT  # For the multi-line output
      - name: Commit & Push
        uses: EndBug/add-and-commit@main
        with:
          default_author: github_actions
          message: ${{ steps.handle.outputs.message }}
  # åŸå§‹çš„ deploy éƒ¨åˆ†å·²ç§»é™¤ï¼Œå› ä¸ºæŒ‡å‘åŸä½œè€…æœåŠ¡å™¨
  # ç°åœ¨ç¿»è¯‘æ›´æ–°åä¼šè‡ªåŠ¨è§¦å‘ pages-deploy.yml éƒ¨ç½²åˆ° GitHub Pages
